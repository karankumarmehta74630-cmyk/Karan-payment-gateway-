<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>503 – Service Unavailable</title>

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">

<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:Poppins}

body{
height:100vh;
display:flex;
justify-content:center;
align-items:center;
background:#f3f4f6;
color:#202124;
overflow:hidden;
}

.container{
max-width:520px;
text-align:center;
padding:30px;
animation:fade .5s ease;
}

@keyframes fade{
from{opacity:0;transform:translateY(10px)}
to{opacity:1;transform:translateY(0)}
}

.error-code{
font-size:90px;
font-weight:700;
color:#d93025;
}

.title{
font-size:22px;
margin-top:10px;
font-weight:600;
}

.subtitle{
margin-top:8px;
color:#5f6368;
font-size:14px;
line-height:1.6;
}

.status{
margin-top:15px;
display:flex;
justify-content:center;
align-items:center;
gap:8px;
font-size:14px;
color:#d93025;
}

.dot{
width:8px;
height:8px;
background:#d93025;
border-radius:50%;
animation:blink 1s infinite;
}

@keyframes blink{
0%{opacity:1}
50%{opacity:.2}
100%{opacity:1}
}

.spinner{
margin:20px auto;
width:28px;
height:28px;
border:3px solid #dadce0;
border-top:3px solid #1a73e8;
border-radius:50%;
animation:spin 1s linear infinite;
}

@keyframes spin{
100%{transform:rotate(360deg)}
}

.retry-text{
font-size:13px;
color:#5f6368;
margin-top:8px;
}

button{
margin-top:15px;
padding:10px 18px;
border:none;
border-radius:6px;
cursor:pointer;
font-weight:500;
font-size:14px;
transition:.3s;
}

.retry-btn{
background:#1a73e8;
color:#fff;
}

.retry-btn:hover{
background:#1765cc;
}

.home-btn{
background:#e8eaed;
color:#202124;
margin-left:8px;
}

.home-btn:hover{
background:#dadce0;
}

/* Floating subtle particles */
.particle{
position:absolute;
width:4px;
height:4px;
background:#d1d5db;
border-radius:50%;
opacity:.3;
animation:float 12s linear infinite;
}

@keyframes float{
0%{transform:translateY(100vh)}
100%{transform:translateY(-10vh)}
}

@media(max-width:480px){
.error-code{font-size:70px}
.container{padding:20px}
}
</style>
</head>
<body>

<div class="container">

<div class="error-code">503</div>

<div class="title">Service Temporarily Unavailable</div>

<div class="subtitle">
Karan Payment Gateway is currently under scheduled maintenance.<br>
Please try again shortly.
</div>

<div class="status">
<div class="dot"></div>
Server Status: Offline
</div>

<div class="spinner"></div>

<div class="retry-text" id="retryTimer">
Retrying in 10 seconds...
</div>

<div>
<button class="retry-btn" onclick="retryNow()">Retry Now</button>
<button class="home-btn" onclick="goHome()">Go to Homepage</button>
</div>

</div>

<script>

// Auto retry countdown
let timeLeft = 10;
let retryTimer = document.getElementById("retryTimer");

let countdown = setInterval(()=>{
retryTimer.innerText = "Retrying in " + timeLeft + " seconds...";
timeLeft--;

if(timeLeft < 0){
clearInterval(countdown);
location.reload();
}
},1000);

function retryNow(){
location.reload();
}

function goHome(){
window.location.href="login.html";
}

// Floating particles
for(let i=0;i<20;i++){
let p=document.createElement("div");
p.className="particle";
p.style.left=Math.random()*100+"vw";
p.style.animationDuration=(8+Math.random()*6)+"s";
document.body.appendChild(p);
}

</script>

</body>
</html></div>

<div class="main">

<!-- Dashboard -->
<div id="dashboard" class="section active">
<div class="card">
<h2>Dashboard</h2>
<p>Total Orders: <span id="totalOrders">0</span></p>
<p>Active QR: <span id="activeQR">No</span></p>
</div>
</div>

<!-- Create Payment -->
<div id="create" class="section">
<div class="card">
<h2>Create Payment</h2>

<input type="number" id="amount" placeholder="Enter Amount ₹">
<button class="primary" onclick="generateQR()">Generate Secure QR</button>

<div id="qrArea"></div>
<p id="orderText"></p>
<p id="amountText"></p>
<p class="timer" id="timer"></p>

</div>
</div>

<!-- History -->
<div id="history" class="section">
<div class="card">
<h2>Payment History</h2>
<div id="historyList"></div>
</div>
</div>

<!-- Profile -->
<div id="profile" class="section">
<div class="card">
<h2>Profile</h2>
<div id="profileBox">Loading...</div>
<button class="primary logout" onclick="logout()">Logout</button>
</div>
</div>

</div>

<script type="module">

import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-auth.js";

const firebaseConfig = {
  apiKey: "AIzaSyBWfnQ9KFDWA5V9_VfqQdWd-vL-psdcqTA",
  authDomain: "karanchatapp-e0b1d.firebaseapp.com",
  projectId: "karanchatapp-e0b1d",
  appId: "1:992252113506:web:c55091651550918a43173b"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);

let orderId="";
let timeLeft=60;
let timer;
let totalOrders=0;

onAuthStateChanged(auth,user=>{
if(!user){
window.location.href="login.html";
}else{
document.getElementById("profileBox").innerHTML=
"<b>Name:</b> "+(user.displayName || "User")+"<br>"+
"<b>Email:</b> "+user.email;
}
});

window.logout=function(){
signOut(auth).then(()=>window.location.href="login.html");
}

window.showSection=function(id){
document.querySelectorAll('.section').forEach(sec=>sec.classList.remove('active'));
document.getElementById(id).classList.add('active');
}

window.generateQR=function(){
let amt=amount.value;
if(!amt || amt<=0){alert("Enter valid amount");return;}

orderId="ORD"+Date.now();
document.getElementById("qrArea").innerHTML="";
new QRCode(document.getElementById("qrArea"),{
text:"Amount ₹"+amt,
width:220,
height:220
});

document.getElementById("orderText").innerText="Order ID: "+orderId;
document.getElementById("amountText").innerText="Amount: ₹"+amt;

startTimer();
saveHistory(orderId,amt);
totalOrders++;
document.getElementById("totalOrders").innerText=totalOrders;
document.getElementById("activeQR").innerText="Yes";
}

function startTimer(){
timeLeft=60;
updateTimer();
clearInterval(timer);
timer=setInterval(()=>{
timeLeft--;
updateTimer();
if(timeLeft<=0){
clearInterval(timer);
document.getElementById("timer").innerText="Expired";
document.getElementById("activeQR").innerText="No";
}
},1000);
}

function updateTimer(){
document.getElementById("timer").innerText="Expires in "+timeLeft+" sec";
}

function saveHistory(id,amt){
let history=JSON.parse(localStorage.getItem("karanPayments"))||[];
history.push({order:id,amount:amt,date:new Date().toLocaleString()});
localStorage.setItem("karanPayments",JSON.stringify(history));
loadHistory();
}

function loadHistory(){
let history=JSON.parse(localStorage.getItem("karanPayments"))||[];
let list=document.getElementById("historyList");
list.innerHTML="";
history.reverse().forEach(item=>{
let div=document.createElement("div");
div.className="history-item";
div.innerHTML=
"<b>"+item.order+"</b><br>"+
"₹"+item.amount+"<br>"+
item.date;
list.appendChild(div);
});
}

loadHistory();

</script>

</body>
</html>
