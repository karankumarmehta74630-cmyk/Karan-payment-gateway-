<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Karan Payment Gateway</title>

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>

<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:Poppins}
body{
background:linear-gradient(135deg,#0f172a,#1e3a8a);
display:flex;
justify-content:center;
align-items:center;
height:100vh;
}

.card{
width:400px;
background:#fff;
border-radius:12px;
box-shadow:0 20px 40px rgba(0,0,0,0.2);
padding:20px;
}

.header{
background:#1e40af;
color:#fff;
padding:14px;
border-radius:8px;
text-align:center;
font-weight:600;
margin-bottom:15px;
font-size:18px;
}

input{
width:100%;
padding:10px;
margin-top:10px;
border:1px solid #ccc;
border-radius:6px;
font-size:14px;
}

button{
width:100%;
padding:10px;
margin-top:10px;
border:none;
border-radius:6px;
background:#1e40af;
color:#fff;
font-weight:600;
cursor:pointer;
}

button:hover{opacity:.9}

.loader{
display:none;
text-align:center;
margin-top:15px;
}

.spinner{
border:4px solid #eee;
border-top:4px solid #1e40af;
border-radius:50%;
width:40px;
height:40px;
animation:spin 1s linear infinite;
margin:auto;
}

@keyframes spin{
100%{transform:rotate(360deg)}
}

#qrSection{
display:none;
margin-top:15px;
text-align:center;
}

.order-info{
margin-top:8px;
font-size:13px;
color:#444;
}

.timer{
margin-top:8px;
font-weight:600;
color:#dc2626;
}

.gateway-name{
margin-top:8px;
font-weight:600;
color:#1e40af;
}

.app-buttons{
display:flex;
gap:8px;
margin-top:10px;
}

.app-buttons button{
flex:1;
font-size:12px;
background:#f1f5f9;
color:#000;
padding:8px;
}

.download-btn{
background:#16a34a;
}

.share-btn{
background:#9333ea;
}

.expired{
color:red;
font-weight:600;
margin-top:8px;
display:none;
}
</style>
</head>
<body>

<div class="card">

<div class="header">
Karan Payment Gateway
</div>

<input type="tel" id="mobile" placeholder="Enter 10 Digit Indian Mobile Number">
<input type="number" id="amount" placeholder="Enter Amount ₹">

<button onclick="createOrder()">Generate Payment QR</button>

<div class="loader" id="loader">
<div class="spinner"></div>
<p>Preparing Secure Payment...</p>
</div>

<div id="qrSection">

<div id="qrcode"></div>

<div class="gateway-name">
Karan Payment Gateway
</div>

<div class="order-info" id="orderText"></div>
<div class="order-info" id="amountText"></div>

<div class="timer" id="timer"></div>

<div class="app-buttons">
<button onclick="openUPI()">GPay</button>
<button onclick="openUPI()">PhonePe</button>
<button onclick="openUPI()">Paytm</button>
</div>

<button class="download-btn" onclick="downloadQR()">Download QR</button>
<button class="share-btn" onclick="sharePayment()">Share QR Details</button>

<div class="expired" id="expiredMsg">
QR Code Expired. Please regenerate.
</div>

<button onclick="createOrder()">Regenerate QR</button>

</div>

</div>

<script>

let countdown;
let timeLeft=60;
let upiLink="";
let orderId="";
let currentAmount="";

function validateMobile(num){
return /^[6-9]\d{9}$/.test(num);
}

function createOrder(){

let mobile=document.getElementById("mobile").value.trim();
let amount=document.getElementById("amount").value.trim();

if(!validateMobile(mobile)){
alert("Enter valid Indian mobile number");
return;
}

if(!amount || amount<=0){
alert("Enter valid amount");
return;
}

currentAmount=amount;

document.getElementById("expiredMsg").style.display="none";
document.getElementById("loader").style.display="block";

setTimeout(()=>{

document.getElementById("loader").style.display="none";
document.getElementById("qrSection").style.display="block";

orderId="ORD"+Date.now();

document.getElementById("orderText").innerText="Order ID: "+orderId;
document.getElementById("amountText").innerText="Amount to Pay: ₹"+currentAmount;

let merchantUPI="merchant@upi"; // replace with official business UPI

upiLink=`upi://pay?pa=${merchantUPI}&pn=Karan&am=${currentAmount}&cu=INR&tn=${encodeURIComponent("Order "+orderId)}`;

document.getElementById("qrcode").innerHTML="";
new QRCode(document.getElementById("qrcode"),{
text: upiLink,
width:200,
height:200
});

startTimer();

},1000);
}

function startTimer(){
timeLeft=60;
updateTimer();
clearInterval(countdown);

countdown=setInterval(()=>{
timeLeft--;
updateTimer();

if(timeLeft<=0){
clearInterval(countdown);
document.getElementById("timer").innerText="Expired";
document.getElementById("expiredMsg").style.display="block";
upiLink="";
}

},1000);
}

function updateTimer(){
document.getElementById("timer").innerText="Expires in "+timeLeft+" seconds";
}

function openUPI(){
if(!upiLink){
alert("QR expired. Regenerate.");
return;
}
window.location.href=upiLink;
}

function downloadQR(){
let canvas=document.querySelector("#qrcode canvas");
let link=document.createElement("a");
link.href=canvas.toDataURL("image/png");
link.download="Karan_Payment_QR_"+orderId+".png";
link.click();
}

function sharePayment(){

if(!orderId){
alert("Generate QR first");
return;
}

let shareText=
"Karan Payment Gateway\n"+
"Order ID: "+orderId+"\n"+
"Amount to Pay: ₹"+currentAmount+"\n"+
"Scan the QR to complete payment.";

if(navigator.share){
navigator.share({
title:"Karan Payment",
text:shareText
});
}else{
window.open("https://wa.me/?text="+encodeURIComponent(shareText));
}

}

</script>

</body>
</html>